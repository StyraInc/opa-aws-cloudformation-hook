{
  "additionalProperties": false,
  "description": "Hook to call out to Open Policy Agent for policy decisions",
  "documentationUrl": "https://www.openpolicyagent.org/docs/latest/aws-cloudformation-hooks/",
  "handlers": {
    "preCreate": {
      "permissions": [
        "secretsmanager:GetSecretValue"
      ],
      "targetNames": [
        "AWS::ACMPCA::*",
        "AWS::AccessAnalyzer::*",
        "AWS::AmazonMQ::*",
        "AWS::Amplify::*",
        "AWS::AmplifyUIBuilder::*",
        "AWS::ApiGateway::*",
        "AWS::ApiGatewayV2::*",
        "AWS::AppConfig::*",
        "AWS::AppFlow::*",
        "AWS::AppMesh::*",
        "AWS::AppStream::*",
        "AWS::AppSync::*",
        "AWS::ApplicationAutoScaling::*",
        "AWS::ApplicationInsights::*",
        "AWS::Athena::*",
        "AWS::AuditManager::*",
        "AWS::AutoScaling::*",
        "AWS::AutoScalingPlans::*",
        "AWS::Backup::*",
        "AWS::Batch::*",
        "AWS::Budgets::*",
        "AWS::CE::*",
        "AWS::Cassandra::*",
        "AWS::CertificateManager::*",
        "AWS::Chatbot::*",
        "AWS::Cloud9::*",
        "AWS::CloudFormation::*",
        "AWS::CloudFront::*",
        "AWS::CloudTrail::*",
        "AWS::CloudWatch::*",
        "AWS::CodeBuild::*",
        "AWS::CodeCommit::*",
        "AWS::CodeDeploy::*",
        "AWS::CodePipeline::*",
        "AWS::CodeStar::*",
        "AWS::CodeStarConnections::*",
        "AWS::CodeStarNotifications::*",
        "AWS::Cognito::*",
        "AWS::Config::*",
        "AWS::DAX::*",
        "AWS::DLM::*",
        "AWS::DMS::*",
        "AWS::DataBrew::*",
        "AWS::DataPipeline::*",
        "AWS::DataSync::*",
        "AWS::Detective::*",
        "AWS::DevOpsGuru::*",
        "AWS::DirectoryService::*",
        "AWS::DynamoDB::*",
        "AWS::EC2::*",
        "AWS::ECR::*",
        "AWS::ECS::*",
        "AWS::EFS::*",
        "AWS::EKS::*",
        "AWS::EMR::*",
        "AWS::EMRContainers::*",
        "AWS::EMRServerless::*",
        "AWS::ElastiCache::*",
        "AWS::ElasticBeanstalk::*",
        "AWS::ElasticLoadBalancing::*",
        "AWS::ElasticLoadBalancingV2::*",
        "AWS::Elasticsearch::*",
        "AWS::EventSchemas::*",
        "AWS::Events::*",
        "AWS::FIS::*",
        "AWS::FMS::*",
        "AWS::FSx::*",
        "AWS::GameLift::*",
        "AWS::GlobalAccelerator::*",
        "AWS::Glue::*",
        "AWS::Greengrass::*",
        "AWS::GuardDuty::*",
        "AWS::IAM::*",
        "AWS::IdentityStore::*",
        "AWS::ImageBuilder::*",
        "AWS::Inspector::*",
        "AWS::InspectorV2::*",
        "AWS::IoT::*",
        "AWS::KMS::*",
        "AWS::KafkaConnect::*",
        "AWS::Kinesis::*",
        "AWS::KinesisAnalytics::*",
        "AWS::KinesisAnalyticsV2::*",
        "AWS::KinesisFirehose::*",
        "AWS::LakeFormation::*",
        "AWS::Lambda::*",
        "AWS::LicenseManager::*",
        "AWS::Logs::*",
        "AWS::M2::*",
        "AWS::MSK::*",
        "AWS::Macie::*",
        "AWS::MediaConnect::*",
        "AWS::MediaConvert::*",
        "AWS::MediaPackage::*",
        "AWS::MemoryDB::*",
        "AWS::Neptune::*",
        "AWS::NetworkFirewall::*",
        "AWS::NetworkManager::*",
        "AWS::Oam::*",
        "AWS::OpenSearchService::*",
        "AWS::OpsWorks::*",
        "AWS::OpsWorksCM::*",
        "AWS::Organizations::*",
        "AWS::Pipes::*",
        "AWS::RAM::*",
        "AWS::RDS::*",
        "AWS::Redshift::*",
        "AWS::RedshiftServerless::*",
        "AWS::Rekognition::*",
        "AWS::ResilienceHub::*",
        "AWS::ResourceExplorer2::*",
        "AWS::ResourceGroups::*",
        "AWS::RolesAnywhere::*",
        "AWS::Route53::*",
        "AWS::Route53Resolver::*",
        "AWS::S3::*",
        "AWS::S3ObjectLambda::*",
        "AWS::S3Outposts::*",
        "AWS::SDB::*",
        "AWS::SES::*",
        "AWS::SNS::*",
        "AWS::SQS::*",
        "AWS::SSM::*",
        "AWS::SSMContacts::*",
        "AWS::SSMIncidents::*",
        "AWS::SSO::*",
        "AWS::SageMaker::*",
        "AWS::SecretsManager::*",
        "AWS::SecurityHub::*",
        "AWS::ServiceCatalog::*",
        "AWS::ServiceCatalogAppRegistry::*",
        "AWS::ServiceDiscovery::*",
        "AWS::Signer::*",
        "AWS::StepFunctions::*",
        "AWS::Synthetics::*",
        "AWS::Transfer::*",
        "AWS::WAF::*",
        "AWS::WAFRegional::*",
        "AWS::WAFv2::*",
        "AWS::WorkSpaces::*",
        "AWS::XRay::*",
        "Alexa::ASK::*"
      ]
    },
    "preDelete": {
      "permissions": [
        "secretsmanager:GetSecretValue"
      ],
      "targetNames": [
        "AWS::ACMPCA::*",
        "AWS::AccessAnalyzer::*",
        "AWS::AmazonMQ::*",
        "AWS::Amplify::*",
        "AWS::AmplifyUIBuilder::*",
        "AWS::ApiGateway::*",
        "AWS::ApiGatewayV2::*",
        "AWS::AppConfig::*",
        "AWS::AppFlow::*",
        "AWS::AppMesh::*",
        "AWS::AppStream::*",
        "AWS::AppSync::*",
        "AWS::ApplicationAutoScaling::*",
        "AWS::ApplicationInsights::*",
        "AWS::Athena::*",
        "AWS::AuditManager::*",
        "AWS::AutoScaling::*",
        "AWS::AutoScalingPlans::*",
        "AWS::Backup::*",
        "AWS::Batch::*",
        "AWS::Budgets::*",
        "AWS::CE::*",
        "AWS::Cassandra::*",
        "AWS::CertificateManager::*",
        "AWS::Chatbot::*",
        "AWS::Cloud9::*",
        "AWS::CloudFormation::*",
        "AWS::CloudFront::*",
        "AWS::CloudTrail::*",
        "AWS::CloudWatch::*",
        "AWS::CodeBuild::*",
        "AWS::CodeCommit::*",
        "AWS::CodeDeploy::*",
        "AWS::CodePipeline::*",
        "AWS::CodeStar::*",
        "AWS::CodeStarConnections::*",
        "AWS::CodeStarNotifications::*",
        "AWS::Cognito::*",
        "AWS::Config::*",
        "AWS::DAX::*",
        "AWS::DLM::*",
        "AWS::DMS::*",
        "AWS::DataBrew::*",
        "AWS::DataPipeline::*",
        "AWS::DataSync::*",
        "AWS::Detective::*",
        "AWS::DevOpsGuru::*",
        "AWS::DirectoryService::*",
        "AWS::DynamoDB::*",
        "AWS::EC2::*",
        "AWS::ECR::*",
        "AWS::ECS::*",
        "AWS::EFS::*",
        "AWS::EKS::*",
        "AWS::EMR::*",
        "AWS::EMRContainers::*",
        "AWS::EMRServerless::*",
        "AWS::ElastiCache::*",
        "AWS::ElasticBeanstalk::*",
        "AWS::ElasticLoadBalancing::*",
        "AWS::ElasticLoadBalancingV2::*",
        "AWS::Elasticsearch::*",
        "AWS::EventSchemas::*",
        "AWS::Events::*",
        "AWS::FIS::*",
        "AWS::FMS::*",
        "AWS::FSx::*",
        "AWS::GameLift::*",
        "AWS::GlobalAccelerator::*",
        "AWS::Glue::*",
        "AWS::Greengrass::*",
        "AWS::GuardDuty::*",
        "AWS::IAM::*",
        "AWS::IdentityStore::*",
        "AWS::ImageBuilder::*",
        "AWS::Inspector::*",
        "AWS::InspectorV2::*",
        "AWS::IoT::*",
        "AWS::KMS::*",
        "AWS::KafkaConnect::*",
        "AWS::Kinesis::*",
        "AWS::KinesisAnalytics::*",
        "AWS::KinesisAnalyticsV2::*",
        "AWS::KinesisFirehose::*",
        "AWS::LakeFormation::*",
        "AWS::Lambda::*",
        "AWS::LicenseManager::*",
        "AWS::Logs::*",
        "AWS::M2::*",
        "AWS::MSK::*",
        "AWS::Macie::*",
        "AWS::MediaConnect::*",
        "AWS::MediaConvert::*",
        "AWS::MediaPackage::*",
        "AWS::MemoryDB::*",
        "AWS::Neptune::*",
        "AWS::NetworkFirewall::*",
        "AWS::NetworkManager::*",
        "AWS::Oam::*",
        "AWS::OpenSearchService::*",
        "AWS::OpsWorks::*",
        "AWS::OpsWorksCM::*",
        "AWS::Organizations::*",
        "AWS::Pipes::*",
        "AWS::RAM::*",
        "AWS::RDS::*",
        "AWS::Redshift::*",
        "AWS::RedshiftServerless::*",
        "AWS::Rekognition::*",
        "AWS::ResilienceHub::*",
        "AWS::ResourceExplorer2::*",
        "AWS::ResourceGroups::*",
        "AWS::RolesAnywhere::*",
        "AWS::Route53::*",
        "AWS::Route53Resolver::*",
        "AWS::S3::*",
        "AWS::S3ObjectLambda::*",
        "AWS::S3Outposts::*",
        "AWS::SDB::*",
        "AWS::SES::*",
        "AWS::SNS::*",
        "AWS::SQS::*",
        "AWS::SSM::*",
        "AWS::SSMContacts::*",
        "AWS::SSMIncidents::*",
        "AWS::SSO::*",
        "AWS::SageMaker::*",
        "AWS::SecretsManager::*",
        "AWS::SecurityHub::*",
        "AWS::ServiceCatalog::*",
        "AWS::ServiceCatalogAppRegistry::*",
        "AWS::ServiceDiscovery::*",
        "AWS::Signer::*",
        "AWS::StepFunctions::*",
        "AWS::Synthetics::*",
        "AWS::Transfer::*",
        "AWS::WAF::*",
        "AWS::WAFRegional::*",
        "AWS::WAFv2::*",
        "AWS::WorkSpaces::*",
        "AWS::XRay::*",
        "Alexa::ASK::*"
      ]
    },
    "preUpdate": {
      "permissions": [
        "secretsmanager:GetSecretValue"
      ],
      "targetNames": [
        "AWS::ACMPCA::*",
        "AWS::AccessAnalyzer::*",
        "AWS::AmazonMQ::*",
        "AWS::Amplify::*",
        "AWS::AmplifyUIBuilder::*",
        "AWS::ApiGateway::*",
        "AWS::ApiGatewayV2::*",
        "AWS::AppConfig::*",
        "AWS::AppFlow::*",
        "AWS::AppMesh::*",
        "AWS::AppStream::*",
        "AWS::AppSync::*",
        "AWS::ApplicationAutoScaling::*",
        "AWS::ApplicationInsights::*",
        "AWS::Athena::*",
        "AWS::AuditManager::*",
        "AWS::AutoScaling::*",
        "AWS::AutoScalingPlans::*",
        "AWS::Backup::*",
        "AWS::Batch::*",
        "AWS::Budgets::*",
        "AWS::CE::*",
        "AWS::Cassandra::*",
        "AWS::CertificateManager::*",
        "AWS::Chatbot::*",
        "AWS::Cloud9::*",
        "AWS::CloudFormation::*",
        "AWS::CloudFront::*",
        "AWS::CloudTrail::*",
        "AWS::CloudWatch::*",
        "AWS::CodeBuild::*",
        "AWS::CodeCommit::*",
        "AWS::CodeDeploy::*",
        "AWS::CodePipeline::*",
        "AWS::CodeStar::*",
        "AWS::CodeStarConnections::*",
        "AWS::CodeStarNotifications::*",
        "AWS::Cognito::*",
        "AWS::Config::*",
        "AWS::DAX::*",
        "AWS::DLM::*",
        "AWS::DMS::*",
        "AWS::DataBrew::*",
        "AWS::DataPipeline::*",
        "AWS::DataSync::*",
        "AWS::Detective::*",
        "AWS::DevOpsGuru::*",
        "AWS::DirectoryService::*",
        "AWS::DynamoDB::*",
        "AWS::EC2::*",
        "AWS::ECR::*",
        "AWS::ECS::*",
        "AWS::EFS::*",
        "AWS::EKS::*",
        "AWS::EMR::*",
        "AWS::EMRContainers::*",
        "AWS::EMRServerless::*",
        "AWS::ElastiCache::*",
        "AWS::ElasticBeanstalk::*",
        "AWS::ElasticLoadBalancing::*",
        "AWS::ElasticLoadBalancingV2::*",
        "AWS::Elasticsearch::*",
        "AWS::EventSchemas::*",
        "AWS::Events::*",
        "AWS::FIS::*",
        "AWS::FMS::*",
        "AWS::FSx::*",
        "AWS::GameLift::*",
        "AWS::GlobalAccelerator::*",
        "AWS::Glue::*",
        "AWS::Greengrass::*",
        "AWS::GuardDuty::*",
        "AWS::IAM::*",
        "AWS::IdentityStore::*",
        "AWS::ImageBuilder::*",
        "AWS::Inspector::*",
        "AWS::InspectorV2::*",
        "AWS::IoT::*",
        "AWS::KMS::*",
        "AWS::KafkaConnect::*",
        "AWS::Kinesis::*",
        "AWS::KinesisAnalytics::*",
        "AWS::KinesisAnalyticsV2::*",
        "AWS::KinesisFirehose::*",
        "AWS::LakeFormation::*",
        "AWS::Lambda::*",
        "AWS::LicenseManager::*",
        "AWS::Logs::*",
        "AWS::M2::*",
        "AWS::MSK::*",
        "AWS::Macie::*",
        "AWS::MediaConnect::*",
        "AWS::MediaConvert::*",
        "AWS::MediaPackage::*",
        "AWS::MemoryDB::*",
        "AWS::Neptune::*",
        "AWS::NetworkFirewall::*",
        "AWS::NetworkManager::*",
        "AWS::Oam::*",
        "AWS::OpenSearchService::*",
        "AWS::OpsWorks::*",
        "AWS::OpsWorksCM::*",
        "AWS::Organizations::*",
        "AWS::Pipes::*",
        "AWS::RAM::*",
        "AWS::RDS::*",
        "AWS::Redshift::*",
        "AWS::RedshiftServerless::*",
        "AWS::Rekognition::*",
        "AWS::ResilienceHub::*",
        "AWS::ResourceExplorer2::*",
        "AWS::ResourceGroups::*",
        "AWS::RolesAnywhere::*",
        "AWS::Route53::*",
        "AWS::Route53Resolver::*",
        "AWS::S3::*",
        "AWS::S3ObjectLambda::*",
        "AWS::S3Outposts::*",
        "AWS::SDB::*",
        "AWS::SES::*",
        "AWS::SNS::*",
        "AWS::SQS::*",
        "AWS::SSM::*",
        "AWS::SSMContacts::*",
        "AWS::SSMIncidents::*",
        "AWS::SSO::*",
        "AWS::SageMaker::*",
        "AWS::SecretsManager::*",
        "AWS::SecurityHub::*",
        "AWS::ServiceCatalog::*",
        "AWS::ServiceCatalogAppRegistry::*",
        "AWS::ServiceDiscovery::*",
        "AWS::Signer::*",
        "AWS::StepFunctions::*",
        "AWS::Synthetics::*",
        "AWS::Transfer::*",
        "AWS::WAF::*",
        "AWS::WAFRegional::*",
        "AWS::WAFv2::*",
        "AWS::WorkSpaces::*",
        "AWS::XRay::*",
        "Alexa::ASK::*"
      ]
    }
  },
  "required": [],
  "sourceUrl": "https://github.com/StyraInc/opa-aws-cloudformation-hook",
  "typeConfiguration": {
    "additionalProperties": false,
    "properties": {
      "opaAuthTokenSecret": {
        "description": "ARN referencing a Secret in Secrets Manager containing a plain-text string token to use for authenticating against the OPA instance",
        "type": "string"
      },
      "opaUrl": {
        "description": "URL pointing to an OPA instance for policy decisions",
        "type": "string"
      }
    },
    "required": [
      "opaUrl"
    ]
  },
  "typeName": "Styra::OPA::Hook"
}
